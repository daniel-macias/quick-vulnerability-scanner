'use client'
import React, { useState } from 'react';
import axios from 'axios';

import DomainScanner from '@/components/Scanners/DomainScanner';
import FileScanner from '@/components/Scanners/FileScanner';
import IPScanner from '@/components/Scanners/IPScanner';
import URLScanner from '@/components/Scanners/URLScanner';

export default function Home() {
  const [apiResponse, setApiResponse] = useState('');
  const [currentScanType, setCurrentScanType] = useState('');
  const [scanData, setScanData] = useState({});

  const handleScan = (scanType : string, data: React.SetStateAction<{}>) => {
    setCurrentScanType(scanType);
    setScanData(data);
    console.log(data);
  };

  const handleScanClick = async () => {
    try {
      const response = await axios.post('/api/ipscan', { ip: '8.8.8.8' }); // Use the actual IP you want to scan
      setApiResponse(JSON.stringify(response.data, null, 2));
    } catch (error) {
      console.error('Error scanning IP:', error);
      setApiResponse("500");
    }
  };

  return (
      <div className="min-h-screen grid md:grid-cols-5 max-h-screen-xl mx-auto">
      {/* Left Half */}
      
      <div className="grid md:grid-rows-6 md:col-span-3 h-full">
        {/* Left Bottom (1/6) */}

        {/* Left Top (5/6) */}
        <div className="md:row-span-6 bg-[#28282d] h-full rounded-md p-4 flex items-center justify-center">
          <div className="bg-[#28282d] h-full rounded-md p-4 flex items-center justify-center">
            {/* Content for the top left section */}
            <div>
              {/* Choose the appropriate scan component based on the currentScanType */}
              <button onClick={handleScanClick} className="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
              Fetch Data
              </button>
              {apiResponse && <pre className="text-white mt-4">{apiResponse}</pre>}
            </div>
          </div>
        </div>


      </div>

      {/* Right Half */}
      <div className="grid md:grid-rows-4 md:col-span-2">
        {/* Right Top (1/4) */}
        <div className="md:row-span-1 bg-[#28282d] h-full rounded-md p-4">
          <FileScanner onScan={(data) => handleScan('file', data)} />
        </div>

        {/* Right Top (1/4) */}
        <div className="md:row-span-1 bg-[#28282d] h-full rounded-md p-4">
          <URLScanner onScan={(data) => handleScan('url', data)} />
        </div>

        {/* Right Top (1/4) */}
        <div className="md:row-span-1 bg-[#28282d] h-full rounded-md p-4">
          <IPScanner onScan={(data) => handleScan('ip', data)} />
        </div>

        {/* Right Top (1/4) */}
        <div className="md:row-span-1 bg-[#28282d] h-full rounded-md p-4">
          <DomainScanner onScan={(data) => handleScan('domain', data)} />
        </div>
      </div>
    </div>
  );
}
